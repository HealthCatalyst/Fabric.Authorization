<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Fabric.AccessControl</title>
</head>
<body>
  <h1 id="waiting">Authenticating...</h1>
  <div id="error"></div>
  <script src="assets/oidc-client.min.js"></script>
<script>
  debugger;
  Oidc.Log.logger = console;
  new Oidc.UserManager().signinRedirectCallback().then(function (user) {
      if (user == null) {
        document.getElementById("waiting").style.display = "none";
        document.getElementById("error").innerText = "No sign-in request pending.";
        console.log("at oidc-callback, but user is null");
      }
      else {
        console.log("user is not null, redirecting to index");
        var url = sessionStorage.getItem('redirect');
        if (url) {
          sessionStorage.removeItem('redirect');
          window.location = url;
        } else {
          window.location = window.location.href.slice(0, window.location.href.indexOf("/oidc-callback.html", "")) + "/access-control";;
        }
      }
    })
    .catch(function (er) {
      document.getElementById("waiting").style.display = "none";
      document.getElementById("error").innerText = er.message;
    });
</script>
</body>
</html>
